# 限界上下文

## 1. 限界上下文的定义

限界上下文（BOUNDED CONTEXT）限界上下文是指一个特定的业务范围内的所有的知识，包括相关的概念、规则和约束条件等。

限界上下文用于划分业务的边界，通过限界上下文把大而混乱的系统切分成各个限界上下文，不仅可以使系统内部的业务概念更清晰，帮助我们更好地理解和管理复杂的业务系统；而且更方便维护，控制变更的范围，减小变更带来的影响。

限界上下文定义了领域模型的应用范围，模型只能在各自的限界上下文内使用，跨上下文通过多种上下文映射关系进行交互，共同协调完成业务逻辑。限界上下文之间的代码重用是很危险的，应该避免。

领域模型只需要在上下文内保证统一，不需要考虑其在上下文外的影响。

## 2. 上下文划分

其实在日常的开发中我们都实践过上下文的划分，只不过没有显式地归纳出来。

限界上下文的划分，主要考虑以下几个点：

首先是基于业务边界进行划分，这是最常见的方法。我们可以将整个系统按照不同的业务功能划分为若干个上下文，每个上下文都有自己的职责和目标。例如，在一个电商系统中，我们可以将订单管理、商品管理、用户管理等功能划分为不同的上下文。这种方法的优点是简单明了，易于理解和实现。

其次是基于技术实现进行限界上下文划分。一般指在已知的上下文中，某些功能的实现需要使用不同的技术架构，因而将其独立出来单独维护。举个例子，商品搜索服务原本位于商品上下文中，但是为了搜索性能，我们引入了搜索引擎，因此我们将商品搜索定义为独立的限界上下文。如果结合商品推荐，由于推荐一般要依赖用户的行为，还包含了用户数据挖掘相关的逻辑，并且这个上下文也有了非常强的业务定位，因此，就不再属于技术实现进行上下文划分了。

## 3. 实践经验

### 3.1 不要过分强调限界上下文划分

DDD 之所以走入当今的窘境，与业界过分注重战略设计、过分强调限界上下文不无关系。

我们要知道，划分限界上下文依据的是事物的本质，DDD 并不产出一个划分限界上下文的方法论。事实上，我们在划分上下文时，采用的还是单一职责等耳熟能详的原则。

举个例子，小猫有尾巴，小狗也有尾巴，我们即使没学过 DDD，也应该知道小猫的尾巴属于小猫，小狗的尾巴属于小狗。我们划分的依据是什么？当然是小猫的尾巴依赖小猫才能存活，与小猫息息相关联系紧密，而不是我们根据什么理论生搬硬套强加的联系。

我们不要过分在意限界上下文的划分结果，更不要认为必须有完美的限界上下文划分结果才能进入开发阶段，我们应该认识到限界上下文划分是一个灵活且持续演进的过程。事实上，我们对业务的理解是一个循序渐进不断发展的过程，可以在实践中随着认识的加深不断的精炼。

当前业界过于强调限界上下文的划分，并且轻视战术落地。没有战术落地的 DDD 只是纸上谈兵，只能产出一张张五颜六色的限界上下文划分图。这些精美的划分图看起来赏心悦目，但是其实仔细推敲，离真正落地还很远，

### 3.2 不要过分强调跨领域模型的统一

在多团队共同开发大型系统时，要求领域模型的完全统一是不可行的，会极大地增加沟通成本。因此，更好的方式时让不同地团队自己在上下文内部完成建模，在自己的限界上下文内形成通用语言，限界上下文之间要尊重历史、尊重差异。

<!--@include: ../footer.md-->
